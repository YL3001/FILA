"use strict";require(["config"],function(){require(["jquery","template","footer","header"],function(l,s,a,n){new Promise(function(e,o){l("header").load("/html/component/header.html",function(){n.head(),e()}),l("footer").load("/html/component/footer.html",function(){a.ft()})}).then(function(){var e={},o=l.cookie("username");console.log(o);var a=["username",o];e[a[0]]=a[1],o?l.ajax({url:"http://localhost/FILAserver/api/car.php",method:"POST",data:e,dataType:"json",success:function(e){console.log(e);for(var o=0;o<e.products.length;o++)e.products[o].img=e.products[o].img.split(",");if(1===e.code){var a=s("car-template",{products:e.products});console.log(a),l("#tbody").html(a);var n=0,t=0;l.each(e.products,function(e,o){console.log(o.num),o.num=parseInt(o.num),o.price=parseInt(o.price),n+=o.num,t+=o.num*o.price}),console.log(n),0===n?l(".nopro").addClass("ac"):(l(".container").addClass("ac"),console.log(t),l("#all-num").prepend("<span>"+n+"</span>"),l("#all-price").append("<span>"+t+"</span>"),l(".all-pay").append("<span>"+t+"</span>"))}}}):l(".content").addClass("ac")}).then(function(){tbody.onclick=function(e){var o=(e=e||event).target||e.srcElement,a=o.parentNode.parentNode;if("delBtn"===o.className){var n=a.firstElementChild.innerHTML;console.log(n),l.ajax({url:"http://localhost/FILAserver/api/delete.php",data:{id:n},method:"GET",dataType:"json",success:function(e){console.log(e),1===e.code?(alert("删除成功！！"),window.location.reload()):alert("删除失败！")}})}else if("btn-default"===o.className){n=a.firstElementChild.innerHTML;var t=l("input",a)[0].value;console.log(n,t),1<t&&(t--,l.ajax({url:"http://localhost/FILAserver/api/update.php",data:{id:n,num:t},method:"GET",dataType:"json",success:function(e){console.log(e),1===e.code&&(alert("更新成功！"),window.location.reload())}}))}else if("btn-add"===o.className){n=a.firstElementChild.innerHTML,t=l("input",a)[0].value;console.log(n,t),t++,l.ajax({url:"http://localhost/FILAserver/api/update.php",data:{id:n,num:t},method:"GET",dataType:"json",success:function(e){console.log(e),1===e.code&&(alert("更新成功！"),window.location.reload())}})}}})})});